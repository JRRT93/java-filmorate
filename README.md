# java-filmorate
Template repository for Filmorate project.
## ERD (https://dbdiagram.io/d/6411da83296d97641d882fd2)
В таблице user в качестве полей все основные поля класса User за исключением Set<Long> friends.
Пока ещё не решил как буду пытаться реализовать функционал подтверждения добавления в друзья, но пока так себе это представляю - 
будет Set<Long> входящих запросов дружбы и Set<Long> исходящих запросов. Для подтверждения или отклонения будет отдельный 
метод, по результатам работы которого id юзера из сета входящих запросов либо перемещается в сет друзей, либо удаляется.
В БД друзья будут храниться в таблице user_friends, где каждому пользователю будет соответствовать столько записей, сколько
у него имеется друзей.

В таблице film также основные поля класса, за исключением сета лайков и будущего сета жанров. Рейтинг от MPA скорее всего
сделаю обычным полем String или перечислением. Для связей фильмов и их жанров отдельная таблица film_genre по аналогии с
user_friends. Также отдельные таблицы для вариантов рейтинга и жанров.

### Примеры запросов
Простые примеры запросов приводить не буду, только топ фильмов по лайкам и перечень общих друзей
#### Запрос на 10 самых популярных по лайкам фильмов

#### Общие друзья
~~~ sql
SELECT one.friend_id 
FROM user_friends AS two
INNER JOIM (SELECT friend_id 
		FROM user_friends
		WHERE user_id = 1) AS one ON one.friend_id = two.friend_id
WHERE user_id = 2
;
~~~

#### Топ фильмов
~~~ 
SELECT f.name AS film_name,
	   COUNT(fl.user_id) AS likes
FROM film_likes AS fl
LEFT JOIN film AS f ON f.film_id = fl.film_id
GROUP BY film_name
ORDER BY likes DESC
LIMIT 10;
~~~